(function(){$(function(){function r(){location.reload(!0)}function u(n,t){abp.message.confirm(abp.utils.formatString(abp.localization.localize("AreYouSureWantToDelete","UltimateInvocing"),t),function(t){t&&i.delete(n).done(function(){r()})})}var i=abp.services.app.emailTemplate,n=$("#EmailTemplateCreateModal"),t=n.find("form");t.validate({});$("#RefreshButton").click(function(){r()});_$emailModal=$("#EmailSettingsEditModal");_$emailSettingsForm=$("form[name='emailSettingsForm']");$("#OpenSettings").click(function(){$("#DefaultFromAddress").val(abp.setting.get("Abp.Net.Mail.DefaultFromAddress"));$("#SmtpHost").val(abp.setting.get("Abp.Net.Mail.Smtp.Host"));$("#SmtpPort").val(abp.setting.get("Abp.Net.Mail.Smtp.Port"));$("#DefaultFromDisplayName").val(abp.setting.get("Abp.Net.Mail.DefaultFromDisplayName"));$("#UserName").val(abp.setting.get("Abp.Net.Mail.DefaultFromAddress"));$("#EnableSsl").val(abp.setting.get("Abp.Net.Mail.Smtp.EnableSsl"));var n=$("form[name='emailSettingsForm']");$.AdminBSB.input.activate(n)});$(".delete-emailTemplate").click(function(){var n=$(this).attr("data-emailTemplate-id"),t=$(this).attr("data-emailTemplate-name");u(n,t)});$(".edit-emailTemplate").click(function(n){var t=$(this).attr("data-emailTemplate-id");n.preventDefault();n.preventDefault();$.ajax({url:abp.appPath+"EmailTemplate/EditEmailTemplateModal?emailTemplateId="+t,type:"POST",contentType:"application/html",success:function(n){$("#EmailTemplateEditModal div.modal-content").html(n)},error:function(){console.log("Failure")}})});_$emailSettingsForm.find('button[type="submit"]').click(function(n){n.preventDefault();var t=_$emailSettingsForm.serializeFormToObject();abp.ui.setBusy(_$emailModal);abp.services.app.email.updateEmailSettings(t).done(function(){_$emailModal.modal("hide")}).always(function(){abp.ui.clearBusy(_$emailModal)})});t.find('button[type="submit"]').click(function(r){if(r.preventDefault(),$(".ql-tooltip").remove(),$("#HtmlContent").val(quill.container.innerHTML),t.valid()){var u=t.serializeFormToObject();console.log(u);abp.ui.setBusy(n);i.create(u).done(function(){n.modal("hide");location.reload(!0)}).always(function(){abp.ui.clearBusy(n)})}});n.on("shown.bs.modal",function(){n.find("input:not([type=hidden]):first").focus()})})})();