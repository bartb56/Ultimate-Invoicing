(function(){$(function(){function r(){location.reload(!0)}function u(n,i){abp.message.confirm(abp.utils.formatString(abp.localization.localize("AreYouSureWantToDelete","UltimateInvocing"),i),function(i){i&&t.delete(n).done(function(){r()})})}var t=abp.services.app.orderItem,n=$("#OrderItemCreateModal"),i=n.find("form");i.validate({});$("#RefreshButton").click(function(){r()});$(".delete-orderItem").click(function(){var n=$(this).attr("data-orderItem-id"),t=$(this).attr("data-orderItem-name");u(n,t)});$(".refresh-product").click(function(){var i=$(this).attr("data-orderItem-id");t.updateProductDetails(i).done(function(){n.modal("hide");location.reload(!0)})});$(".edit-orderItem").click(function(n){var t=$(this).attr("data-orderItem-id");n.preventDefault();n.preventDefault();$.ajax({url:abp.appPath+"OrderItem/Edit?orderItemId="+t,type:"POST",contentType:"application/html",success:function(n){console.log("success");$("#OrderItemEditModal div.modal-content").html(n)},error:function(){console.log("Failure")}})});i.find('button[type="submit"]').click(function(r){var u,f;(r.preventDefault(),i.valid())&&(u=i.serializeFormToObject(),console.log(u),abp.ui.setBusy(n),console.log(u.ProductId),f=abp.services.app.product,f.getStock(u.ProductId).done(function(i){i>=u.Quantity?t.create(u).done(function(){n.modal("hide");location.reload(!0)}).always(function(){abp.ui.clearBusy(n)}):(abp.ui.clearBusy(n),abp.message.confirm(abp.localization.localize("LowStockDesc","UltimateInvocing"),abp.localization.localize("LowStock","UltimateInvocing"),function(i){i&&(abp.ui.setBusy(n),t.create(u).done(function(){n.modal("hide");location.reload(!0)}).always(function(){abp.ui.clearBusy(n)}))}))}))});n.on("shown.bs.modal",function(){n.find("input:not([type=hidden]):first").focus()})})})();